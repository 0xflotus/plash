#!/usr/bin/env python3

# usage: plash rm [CONTAINER1 [CONTAINER2 [CONTAINER3 ...]]]
# Deletes the given containers.

from subprocess import check_output, CalledProcessError
import os
import sys
from shutil import rmtree
from tempfile import mkdtemp
from plashlib.utils import handle_help_flag, catch_and_die, call_plash_nodepath

handle_help_flag()

PLASH_DATA = os.environ.get('PLASH_DATA', '/var/lib/plash')

for container in sys.argv[1:]:
    node = call_plash_nodepath(container)
    tmp = mkdtemp(dir=PLASH_DATA)
    os.rename(node, tmp)
    rmtree(tmp)
