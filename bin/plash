#!/usr/bin/env python3

import os
import sys

import plash
import pkgutil
import inspect


subcommand = sys.argv[1]
subcommand_args = sys.argv[1:]

# very ugly, no idea how this is suppsed to be done
from plash import core
module_dir = os.path.dirname(os.path.abspath(core.__file__))
subcommands_dir = os.path.join(module_dir, '..', 'data', 'bin')


subcommand_executable = os.path.join(subcommands_dir, subcommand)
try:
    os.execvpe(
        subcommand_executable,
        [subcommand_executable] + subcommand_args,
        dict())
except FileNotFoundError:
    all_subcommands = os.listdir(subcommands_dir)
    print('No subcommand {}, available: {}'.format(repr(subcommand), ' '.join(sorted(all_subcommands))))
