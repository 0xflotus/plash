#!/usr/bin/env python3
from plash.utils import setup_sigint_handler; setup_sigint_handler()

import inspect
import os
import sys

import plash
from plash import utils

args = sys.argv[1:]

# "do run" is used as default command when no other was given
if not args:
    # error('Plash is a container build system, try --help')
    print('Plash is a lean container build system, try --help') # we need some adjective here, maybe not lean?
    sys.exit(1)
if args[0].startswith('-'):
    args = ['do', 'run'] + args

subcommand = args[0]
subcommand_args = args[1:]

subcommand_executable = utils.get_subcommand_path(subcommand)
try:
    os.execvpe(
        subcommand_executable,
        [subcommand_executable] + subcommand_args,
        os.environ)
except FileNotFoundError:
    print(utils.red('No subcommand {} available, try --help for list'.format(repr(subcommand))), file=sys.stderr)
    sys.exit(1)
